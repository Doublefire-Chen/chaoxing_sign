webpackJsonp([1],{"1sSq":function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("7+uW"),a=s("NCfY"),r=s("Au9i"),i=s.n(r);var o={name:"App",data:function(){return{usersSelected:[],users:[],usersToSign:[],usersSigned:[],selected:"1",scanOpen:!1,apiKey:""}},components:{QrcodeStream:a.QrcodeStream},mounted:function(){var e=this;this.setUpApiKey()&&this.axios.get("/scan").then(function(t){for(var s=0;s<t.data.length;s++)e.users.push({value:t.data[s].username,label:t.data[s].name})})},methods:{setUpApiKey:function(){return this.apiKey=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var s=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return s?s[2]?decodeURIComponent(s[2].replace(/\+/g," ")):"":null}("api-key"),""==this.apiKey||null==this.apiKey?(Object(r.Toast)("403: 无权限访问"),!1):(console.log("apiKey: "+this.apiKey),n.default.axios.defaults.headers.common["api-key"]=this.apiKey,!0)},startSign:function(){this.usersToSign=[];for(var e=0;e<this.users.length;e++)this.usersSelected.indexOf(this.users[e].value)>=0&&this.usersToSign.push({username:this.users[e].value,name:this.users[e].label});Object(r.Toast)("开始签到"),this.selected="2"},onDecode:function(e){var t=this;if(""!==e){var s=e.split("&").filter(function(e){return e.startsWith("enc=")});if(0!==s.length){s=s[0].substr(4),this.scanOpen=!1,r.Indicator.open("正在签到...");for(var n=[],a=0;a<this.usersToSign.length;a++)n.push(this.usersToSign[a].username);var i={sign_users:n,enc:s},o=this;this.axios.post("/scan",i).then(function(e){for(var s=0;s<e.data.length;s++)t.usersSigned.push(e.data[s]);var n=t.usersToSign.filter(function(t){for(var s=0;s<e.data.length;s++)if(e.data[s].username===t.username)return!1;return!0});o.usersToSign=n,r.Indicator.close();var a=e.data.map(function(e){return e.name});Object(r.Toast)("签到成功："+a.join(", "))}).catch(function(){r.Indicator.close()})}}}}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("mt-navbar",{model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[s("mt-tab-item",{attrs:{id:"1"}},[e._v("选择签到人")]),e._v(" "),s("mt-tab-item",{attrs:{id:"2"}},[e._v("未签到")]),e._v(" "),s("mt-tab-item",{attrs:{id:"3"}},[e._v("已签到")])],1),e._v(" "),s("mt-tab-container",{model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[s("mt-tab-container-item",{attrs:{id:"1"}},[s("mt-checklist",{attrs:{title:"选择需要签到的人",options:e.users},model:{value:e.usersSelected,callback:function(t){e.usersSelected=t},expression:"usersSelected"}}),e._v(" "),s("div",{staticClass:"confirm"},[s("mt-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.startSign(t)}}},[e._v("确认")])],1)],1),e._v(" "),s("mt-tab-container-item",{attrs:{id:"2"}},[s("p"),e._v(" "),s("div",{staticClass:"scan-qrcode"},[e.scanOpen?s("qrcode-stream",{on:{decode:e.onDecode}}):e._e()],1),e._v(" "),s("div",{staticClass:"scan-open"},[s("mt-switch",{model:{value:e.scanOpen,callback:function(t){e.scanOpen=t},expression:"scanOpen"}},[e._v("开启扫码")])],1),e._v(" "),s("div",{staticClass:"notOK"},e._l(e.usersToSign,function(e,t){return s("mt-cell",{key:t,attrs:{title:e.name}})}),1)]),e._v(" "),s("mt-tab-container-item",{attrs:{id:"3"}},[s("p"),e._v(" "),s("div",{staticClass:"OK"},e._l(e.usersSigned,function(e,t){return s("mt-cell",{key:t,attrs:{title:e.name}})}),1)])],1)],1)},staticRenderFns:[]};var l=s("VU/8")(o,u,!1,function(e){s("umP2")},null,null).exports,c=s("/ocq"),v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"hello"},[s("h1",[e._v(e._s(e.msg))]),e._v(" "),s("h2",[e._v("Essential Links")]),e._v(" "),e._m(0),e._v(" "),s("h2",[e._v("Ecosystem")]),e._v(" "),e._m(1)])},staticRenderFns:[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ul",[s("li",[s("a",{attrs:{href:"https://vuejs.org",target:"_blank"}},[e._v("\n        Core Docs\n      ")])]),e._v(" "),s("li",[s("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank"}},[e._v("\n        Forum\n      ")])]),e._v(" "),s("li",[s("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank"}},[e._v("\n        Community Chat\n      ")])]),e._v(" "),s("li",[s("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank"}},[e._v("\n        Twitter\n      ")])]),e._v(" "),s("br"),e._v(" "),s("li",[s("a",{attrs:{href:"http://vuejs-templates.github.io/webpack/",target:"_blank"}},[e._v("\n        Docs for This Template\n      ")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[t("a",{attrs:{href:"http://router.vuejs.org/",target:"_blank"}},[this._v("\n        vue-router\n      ")])]),this._v(" "),t("li",[t("a",{attrs:{href:"http://vuex.vuejs.org/",target:"_blank"}},[this._v("\n        vuex\n      ")])]),this._v(" "),t("li",[t("a",{attrs:{href:"http://vue-loader.vuejs.org/",target:"_blank"}},[this._v("\n        vue-loader\n      ")])]),this._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank"}},[this._v("\n        awesome-vue\n      ")])])])}]};var d=s("VU/8")({name:"HelloWorld",data:function(){return{msg:"Welcome to Your Vue.js App"}}},v,!1,function(e){s("1sSq")},"data-v-d8ec41bc",null).exports;n.default.use(c.a);var h=new c.a({routes:[{path:"/",name:"HelloWorld",component:d}]}),p=(s("d8/S"),s("DWlv")),m=s.n(p),f=s("mtWM"),_=s.n(f);n.default.config.productionTip=!1,n.default.use(m.a,_.a),n.default.axios.defaults.baseURL="/api",n.default.use(i.a),new n.default({el:"#app",router:h,components:{App:l},template:"<App/>"})},"d8/S":function(e,t){},umP2:function(e,t){}},["NHnr"]);